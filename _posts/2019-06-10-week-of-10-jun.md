---
layout: post
title: "week of 10 jun"
date: 2019-06-10
---

### 10 jun

New week! Gonna be a short one since I'm taking Friday off for Shelley's wedding! :tada:

The plan for the week is to get the apps I tested last week into a docker container with wordpress and see what happens. In theory, this shouldn't be a problem. I have a working wordpress docker container and a working docker container with the apps... now to get them to work together? Or create a new hybrid version? I found the WP database in adminer (`wordpress-www`)... I wonder how much of this I need to make the whole thing work in docker? Maybe I should start with the dev site data?

#### wp docker

Took a bit of doing, but I think I have it figured out now. Everything's up and running... and I need to publish this to a private repo because I don't want to lose it or screw it up and not be able to undo it.

Well, I tried to put it in github, but there were too many obstacles. This repo would've needed a submodule since the WP theme is actually another github repo. I was tempted to delete all the git information and push it anyway, but there are so many crazy vendor files/packages in there that would need to be ignored that it wasn't worth the trouble of doing the whole thing. So, nvm, I guess.

Good news, tho: all the homepage apps are now loading and successfully serving GET endpoints so that this docker wp image looks just like the dev site. Woo! I need to import the rest of the apps and find out where they're being served in the rest of the site. 

I also need to ask Steven how he added that app management widget to the backend so I can get that going in the docker container. I assume I can find it somewhere in the production wordpress build, but what would it even be called?

Decided to copy all the currently activated plugins from the production server to the docker app. I'm not sure what they all do, but it's probably something I need to be aware of for this migration. I was hoping one of these would be the thing that controlled the "UA Lib WebApps" icon in the header of the admin dashboard, but that's not the case as far as I can tell.

So maybe tomorrow I continue on this copying some stuff from the production server journey. Then I can export all the post/plugin data and try to import some of it to the docker version and see what sticks.

### 11 jun

I'm trying to figure out this admin bar user group menu, but it seems like a giant mobius strip catch-22 situation. The menu won't show up unless I'm in these user groups, but how do I set myself as a member of the user group if there's no menu??? I'm assuming I need to add myself to the user groups database... but yuck. 

I added myself to the `webapps_userGroups` database like this:

```
insert into userGroups (name, wpLogin, groups) values ("Caryl Wyatt", "cewyatt", 2047);
```

So I'm in the database now, but the admin bar menu still isn't showing up, so there must be something else going on.

I started going function by function through the userGroupsAdmin index.php/functions.php, and there's definitely something going on with JWT. I var_dumped the `apache_request_headers()` in `gGetTokenJWT()` function, and it's missing the 'Authorization' header. Where is that set, I wonder?

I just fell into a very deep hole of complication. Lots of moving parts, here:
- `manage` app:
  - `manage.js` which I think is the factory for the API and handles authentication
  - `manageUserGroups.js` which I think is the front-end for adding/deleting users
- `userGroupsAdmin` API that handles all the backend/database info...
- `JWT` php library -- has nothing to do with WP specifically, but our code interacts with it via WP almost exclusively

I'm not even sure where to start with all this, but I have to dig in somewhere.
