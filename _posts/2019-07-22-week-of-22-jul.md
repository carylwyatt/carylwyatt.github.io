---
layout: post
title: "week of 22 jul"
date: 2019-07-22
---

### 22 jul 

To do this week:
- Finalize instruction form look/feel
- Continue intranet content migration
- Fix my docker container so I can test the LDAP plugin with the correct PHP modules

#### intranet

Rudaina and I continue our progress with migrating content to the intranet. 

I ran into yet another WP REST API interference with a plugin. I really don't want to try to diagnose this on appsdev as I'm assuming it's an outdated plugin or something similar that's blocking the API. I tested the same plugin on my localhost version with no problem, so it probably has something to do with version 5.1 of WP on PHP 5.5. The only other thing it could be is a setting in the UA theme. I find this highly unlikely because a) they have screenshots of using the Gutenberg editor, which also relies on the API being accessible, and b) they use lots of shortcodes, which are only available via Gutenberg. 

I also had success finding the list of drupal users and what roles everyone has. Now to decipher what these user roles have access to edit...

We also realized the sidebar menu wasn't displaying the children pages in the navigation. I looked into this briefly, and it looks like that behavior/functionality was commented out of the sidebar nav walker at some point. I've added this to my list of things to look into.

#### instruction form

I decided to spend a little bit of time seeing what of the instruction form I could clean up quickly. The instruction part looks much better, but I can't figure out a good way to alter the form itself without affecting the rest of the forms in libcal. I'm pretty annoyed right now because every other app in the springshare suite uses very specific ID numbers attached to content pieces, but these forms don't have their own IDs! The questions in the forms do, but the forms themselves do not. :expressionless: So figuring this out should be fun.

### 23 jul

Focusing on the intranet this morning, specifically the sidebar submenu situation. It's time to dive into WP `Walker_Nav_Menu` class to see where I can inject some functionality.

I started looking into this, and yes, I think this will be a pretty easy fix.

Unfortunately, I got sidetracked by a kace ticket while I was testing some stuff. I had to switch gears and start thinking about how to update one of the custom forms we have on the website... which led to quite the rabbit hole. I have a plan for fixing that, but it did take up a chunk of time from my morning.

Then Steven sent out the meeting agenda, and he wants to discuss the future of our wordpress workflow, auto deployment, and github setup. There's a TON of research I need to do to be able to speak on that intelligently, so that took precedence in between my doctor appointment and lunch and now about an hour before the meeting.

So now I'm reading up on webpack and CI, since those are both things that could really help our development and deployment flow. For one, we have to leave grunt and bower behind because a) Bower has been archived and is only getting security updates, and b) some of our grunt plugins are causing security vulnerabilities in our repos because they haven't been updated in 4-5 **years**. That's definitely a sign that it's time to move on to a new tool, and webpack should be the way forward. It does bundling, minifying, etc. like grunt, and we can use npm to include our packages and dependencies instead of bower. 

This article has been enlightening: [Webpack for WordPress](https://carrieforde.com/webpack-wordpress/)

### 24 jul

We had a long meeting yesterday, so I didn't get the chance to get back to work on the sidebar menu. That's what I'll do today. :raised-hands:

I've spent most of the morning fiddling around with this stupid sidebar template and I've just finally figured out how to get the stupid collapse/dropdown feature to cooperate. Very frustrating! Now hopefully I can tinker just a bit more with the php and css and get it working well and looking nice and I can move on to something else. Helpful articles in figuring this out:
- [CSS Tricks: The WordPress nav walker class: a guided var_dump()](https://css-tricks.com/the-wordpress-nav-walker-class-a-guided-var_dump/)
- [Custom walker: How to get ID in function start_lvl](https://wordpress.stackexchange.com/questions/62054/custom-walker-how-to-get-id-in-function-start-lvl?rq=1)
- [Bootstrap: How do I make Dropdown navigation parent links an active link?](https://stackoverflow.com/questions/25692514/bootstrap-how-do-i-make-dropdown-navigation-parent-links-an-active-link)
- [W3 schools: Bootstrap collapse](https://www.w3schools.com/bootstrap/bootstrap_collapse.asp)

I tinkered with the php and now realize I'mma be devastated when the UA theme gets updated and this gets overwritten. I've been googling about how to properly override or extend a parent theme class, and there might be a way, but I don't know enough about PHP to be sure this is going to fly. Do I dare? 

OMG, I figured it out! :tada::sparkles: Many thanks to [How to extend a parent theme class from child theme?](https://wordpress.org/support/topic/how-to-extend-a-parent-theme-class-from-child-theme-in/) and [WordPress: Override parent theme class function in child theme](https://stackoverflow.com/questions/53293310/wordpress-override-parent-theme-class-function-in-child-theme)

The styling took a little bit longer to figure out than anticipated. Styling nav menus is pretty much the bane of my existence, but it really wasn't all that bad. The hard part was forcing the toggle/dropdown menu to stay open once the user clicks a child page in the menu. I fixed it using javascript, but because the child theme functions load before the parent theme has time to do its thing, I had to use a document ready function which was making the navigation jumpy on load. I decided it was time to mess around with the wp/php a bit more and I'm glad I did!

I ended up var_dumping the `$item` array I created for the previous toggle issue to see what good stuff was in there I could exploit. Turns out, the array lists all the classes of that item. Because one of those items was `current-page-parent`, I could use that to change the `$output` variable for children of those parents. Boom! It's pretty simple now that I'm looking at it, but thinking in PHP terms and knowing what to dump and look at is taking me some time to wrap my head around. :100: 

I may want this stack overflow later if we decide to do grandchildren in that menu: [Custom nav walker display current menu item children, or siblings no children](https://wordpress.stackexchange.com/questions/83388/custom-nav-walker-display-current-menu-item-children-or-siblings-on-no-children)
